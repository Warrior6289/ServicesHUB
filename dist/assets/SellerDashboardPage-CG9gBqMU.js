import{j as e,m as r,A as t}from"./ui-D5g_oJ6l.js";import{r as a,c as s}from"./vendor-BQpy66Z4.js";import{R as i}from"./RatingBlock-DmSbiGqk.js";import{u as l}from"./index.esm-Cli8lVPl.js";import{d as n,S as o,a as d,b as c,r as m,u,e as x}from"./ServiceRequestCard-xfqRK5Iy.js";import{c as g}from"./index-vhHMrfFc.js";import{a as p}from"./serviceRequests-CJCfd_jz.js";import{S as h,u as y,i as b}from"./sellerProfile-DZrTRoRK.js";import"./router-BYxgfnPJ.js";import"./utils-BKFvrhvV.js";const v=({listing:t,onToggleStatus:a,onEdit:s,onRemove:l})=>e.jsxs(r.div,{initial:{opacity:0,y:8},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.25},className:"group rounded-xl border border-slate-200 p-4 hover:shadow-lg hover:-translate-y-0.5 transition-all duration-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:t.title}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:t.description}),e.jsxs("div",{className:"mt-2 flex items-center gap-3 text-sm",children:[e.jsxs("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 dark:bg-slate-800",children:["Views: ",t.views]}),e.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 "+("available"===t.status?"bg-green-100 text-green-800":"bg-amber-100 text-amber-800"),children:t.status})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-semibold",children:["$",t.price.toFixed(2)]}),e.jsx("div",{className:"mt-1",children:e.jsx(i,{rating:t.rating})})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsxs("button",{className:"rounded-md border px-3 py-1.5 text-sm hover:bg-slate-50 dark:hover:bg-slate-800",onClick:()=>a(t.id),children:["Mark ","available"===t.status?"as Sold":"as Available"]}),e.jsx("button",{className:"rounded-md border px-3 py-1.5 text-sm hover:bg-slate-50 dark:hover:bg-slate-800",onClick:()=>s(t.id),children:"Edit"}),e.jsx("button",{className:"rounded-md bg-red-600 px-3 py-1.5 text-sm text-white hover:bg-red-700",onClick:()=>l(t.id),children:"Remove"})]})]}),f=({initial:r,onSubmit:t})=>{const{register:a,handleSubmit:s,formState:{isSubmitting:i}}=l({defaultValues:r??{title:"",price:0,description:""}});return e.jsxs("form",{onSubmit:s(async e=>{await new Promise(e=>setTimeout(e,400)),null==t||t(e)}),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Title"}),e.jsx("input",{...a("title"),className:"mt-1 w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-slate-900 placeholder-slate-400 shadow-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Price"}),e.jsx("input",{type:"number",step:"0.01",...a("price",{valueAsNumber:!0}),className:"mt-1 w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-slate-900 placeholder-slate-400 shadow-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Description"}),e.jsx("textarea",{rows:3,...a("description"),className:"mt-1 w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-slate-900 placeholder-slate-400 shadow-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-100"})]}),e.jsx("button",{type:"submit",disabled:i,className:"inline-flex items-center justify-center rounded-md bg-primary-600 px-4 py-2 text-white hover:bg-primary-700 disabled:opacity-70",children:"Save Listing"})]})};function j({enabled:e,intervalMs:r=2e4,radius:t=50,categoryId:s,useMockData:i=!0}){const[l,n]=a.useState([]),[o,d]=a.useState(!1),[c,m]=a.useState(null),[u,x]=a.useState(0),h=a.useRef(new Set),y=a.useRef(null),b=a.useCallback(async()=>{try{let e;d(!0),m(null),e=i?p():await async function(e,r){try{const t=new URLSearchParams;t.append("radius",e.toString()),r&&t.append("categoryId",r);const{data:a}=await g.get(`/service-requests/nearby?${t.toString()}`);return a}catch(c){throw c}}(t,s);const r=new Set(e.map(e=>e.id)),a=h.current,l=Array.from(r).filter(e=>!a.has(e));l.length>0&&a.size>0&&(x(e=>e+l.length),"Notification"in window&&"granted"===Notification.permission&&new Notification("New Service Request!",{body:`${l.length} new request(s) available`,icon:"/vite.svg"})),h.current=r,n(e)}catch(e){m(e)}finally{d(!1)}},[e,t,s,i]),v=a.useCallback(()=>{b()},[b]),f=a.useCallback(()=>{x(0)},[]);return a.useEffect(()=>{b()},[e,b]),a.useEffect(()=>{if(r>0)return y.current=setInterval(()=>{b()},r),()=>{y.current&&clearInterval(y.current)}},[e,r,b]),a.useEffect(()=>{const e=()=>{b()};return window.addEventListener("focus",e),()=>{window.removeEventListener("focus",e)}},[e,b]),a.useEffect(()=>{"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission()},[e]),{requests:l,loading:o,error:c,refetch:v,newRequestsCount:u,resetNewRequestsCount:f}}const k=({initial:t,onSubmit:a})=>{var i,n,o;const[d,c]=s.useState(!1),[m,u]=s.useState(!1),[x,g]=s.useState(""),[p,b]=s.useState((null==t?void 0:t.profilePicture)||null),[v,f]=s.useState(!1),[j,k]=s.useState(""),{register:N,handleSubmit:w,formState:{errors:S},watch:C,setValue:P,reset:M}=l({defaultValues:{name:(null==t?void 0:t.name)||"",email:(null==t?void 0:t.email)||"",phone:(null==t?void 0:t.phone)||"",bio:(null==t?void 0:t.bio)||"",location:(null==t?void 0:t.location)||"",yearsOfExperience:(null==t?void 0:t.yearsOfExperience)||0,serviceCategories:(null==t?void 0:t.serviceCategories)||[],certifications:(null==t?void 0:t.certifications)||[]},mode:"onBlur"}),L=C("serviceCategories"),R=C("certifications"),A=()=>{x.trim()&&!R.includes(x.trim())&&(P("certifications",[...R,x.trim()]),g(""))},T=s.useMemo(()=>{if(!j.trim())return h;const e=j.toLowerCase();return h.filter(r=>r.toLowerCase().includes(e))},[j]),E=s.useMemo(()=>{const e={"Construction & Building":[],"Home Services":[],"Technical Services":[],Automotive:[],"Personal Services":[],"Professional Services":[],"Health & Wellness":[],"Creative Services":[],"Maintenance & Repair":[],"Specialized Services":[],"Business Services":[]};return T.forEach(r=>{["Plumber","Electrician","Welder","Carpenter","Painter","HVAC","Roofing","Flooring","Masonry","Drywall","Insulation","Concrete Work","Fencing","Landscaping"].includes(r)?e["Construction & Building"].push(r):["Cleaning","Housekeeping","Laundry","Pest Control","Window Cleaning","Carpet Cleaning","Pressure Washing","Gutter Cleaning","Snow Removal"].includes(r)?e["Home Services"].push(r):["Technician","Computer Repair","Phone Repair","Appliance Repair","Electronics Repair","Network Setup","Security Systems","Smart Home Installation"].includes(r)?e["Technical Services"].push(r):["Auto Mechanic","Auto Body Repair","Tire Service","Oil Change","Car Wash","Auto Detailing","Towing"].includes(r)?e.Automotive.push(r):["Hair Stylist","Barber","Makeup Artist","Nail Technician","Massage Therapist","Personal Trainer","Photographer","Videographer","Event Planner"].includes(r)?e["Personal Services"].push(r):["Accountant","Lawyer","Consultant","Translator","Tutor","Music Teacher","Language Teacher","Life Coach"].includes(r)?e["Professional Services"].push(r):["Yoga Instructor","Pilates Instructor","Nutritionist","Physical Therapist","Chiropractor","Dentist","Veterinarian"].includes(r)?e["Health & Wellness"].push(r):["Graphic Designer","Web Designer","Artist","Writer","Editor","Musician","DJ","Singer"].includes(r)?e["Creative Services"].push(r):["Handyman","Locksmith","Appliance Installation","Furniture Assembly","Moving Services","Storage Solutions"].includes(r)?e["Maintenance & Repair"].push(r):["Pool Maintenance","Spa Services","Pet Grooming","Pet Sitting","Childcare","Elderly Care","House Sitting","Plant Care"].includes(r)?e["Specialized Services"].push(r):["Virtual Assistant","Data Entry","Bookkeeping","Social Media Management","Content Creation","Marketing","Sales","Customer Service"].includes(r)&&e["Business Services"].push(r)}),Object.entries(e).filter(([e,r])=>r.length>0)},[T]);return e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Seller Profile"}),!d&&e.jsx("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors text-sm font-medium",children:"Edit Profile"})]}),e.jsxs("form",{onSubmit:w(async e=>{u(!0);try{await new Promise(e=>setTimeout(e,1e3)),y(e),c(!1),null==a||a(e),alert("Profile updated successfully!")}catch(r){alert("Failed to update profile. Please try again.")}finally{u(!1)}}),className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative w-20 h-20 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center overflow-hidden",children:[p?e.jsx("img",{src:p,alt:`${(null==t?void 0:t.name)||"User"} profile picture`,className:"w-full h-full object-cover rounded-full",role:"img","aria-label":"Profile picture"}):e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),v&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded-full",children:e.jsxs("svg",{className:"w-6 h-6 text-white animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]}),d&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("label",{className:"px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:async e=>{var r;const a=null==(r=e.target.files)?void 0:r[0];if(a)if(a.type.startsWith("image/"))if(a.size>5242880)alert("Image size should be less than 5MB");else{f(!0);try{const e=new FileReader;e.onload=e=>{var r;const a=null==(r=e.target)?void 0:r.result;b(a);const s={...t,profilePicture:a};localStorage.setItem("sellerProfile",JSON.stringify(s)),f(!1),alert("Profile picture updated successfully!")},e.readAsDataURL(a)}catch(s){alert("Failed to upload image. Please try again."),f(!1)}}else alert("Please select an image file")},className:"hidden",disabled:v,"aria-label":"Upload profile picture"}),v?"Uploading...":"Upload Photo"]}),p&&e.jsx("button",{type:"button",onClick:()=>{b(null);const e={...t,profilePicture:void 0};localStorage.setItem("sellerProfile",JSON.stringify(e))},className:"px-3 py-1.5 text-sm text-red-600 dark:text-red-400 border border-red-300 dark:border-red-600 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:"Remove Photo"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name *"}),d?e.jsx("input",{...N("name",{required:"Name is required"}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Your full name"}):e.jsx("p",{className:"text-gray-900 dark:text-white",children:(null==t?void 0:t.name)||"Not provided"}),S.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:S.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email *"}),d?e.jsx("input",{type:"email",...N("email",{required:"Email is required"}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"your@email.com"}):e.jsx("p",{className:"text-gray-900 dark:text-white",children:(null==t?void 0:t.email)||"Not provided"}),S.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:S.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone"}),d?e.jsx("input",{...N("phone"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"+1 (555) 123-4567"}):e.jsx("p",{className:"text-gray-900 dark:text-white",children:(null==t?void 0:t.phone)||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Years of Experience"}),d?e.jsx("input",{type:"number",min:"0",max:"50",...N("yearsOfExperience",{valueAsNumber:!0}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"5"}):e.jsxs("p",{className:"text-gray-900 dark:text-white",children:[(null==t?void 0:t.yearsOfExperience)||0," years"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Location"}),d?e.jsx("input",{...N("location"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"City, State"}):e.jsx("p",{className:"text-gray-900 dark:text-white",children:(null==t?void 0:t.location)||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Bio / Service Description"}),d?e.jsx("textarea",{...N("bio"),rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 resize-none",placeholder:"Tell customers about your services, experience, and what makes you unique..."}):e.jsx("p",{className:"text-gray-900 dark:text-white whitespace-pre-wrap",children:(null==t?void 0:t.bio)||"No bio provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Service Categories *"}),d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search categories...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:j,onChange:e=>k(e.target.value)}),j?e.jsx("button",{onClick:()=>k(""),className:"absolute right-3 top-2.5 w-5 h-5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}):e.jsx("svg",{className:"absolute right-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Quick filters:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[["Construction","Home","Technical","Automotive","Personal","Professional","Health","Creative"].map(r=>e.jsx("button",{onClick:()=>k(r),className:"px-3 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:r},r)),e.jsx("button",{onClick:()=>k(""),className:"px-3 py-1 text-xs bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 rounded-full hover:bg-primary-200 dark:hover:bg-primary-900/50 transition-colors",children:"Clear"})]})]}),e.jsxs("div",{className:"max-h-80 overflow-y-auto space-y-4",children:[E.map(([r,t])=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-800 dark:text-gray-200 border-b border-gray-200 dark:border-gray-600 pb-1",children:r}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 ml-2",children:t.map(r=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded",children:[e.jsx("input",{type:"checkbox",checked:(null==L?void 0:L.includes(r))||!1,onChange:()=>(e=>{const r=L||[];r.includes(e)?P("serviceCategories",r.filter(r=>r!==e)):P("serviceCategories",[...r,e])})(r),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:r})]},r))})]},r)),0===T.length&&j&&e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsxs("p",{children:['No categories found matching "',j,'"']}),e.jsx("button",{onClick:()=>k(""),className:"mt-2 text-primary-600 dark:text-primary-400 hover:underline text-sm",children:"Clear search"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(null==L?void 0:L.length)||0," categories selected"]})]}):e.jsx("div",{className:"flex flex-wrap gap-2",children:(null==(i=null==t?void 0:t.serviceCategories)?void 0:i.map(r=>e.jsx("span",{className:"px-3 py-1 bg-primary-100 dark:bg-primary-900/30 text-primary-800 dark:text-primary-200 rounded-full text-sm",children:r},r)))||e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No categories selected"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Certifications"}),d?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:x,onChange:e=>g(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),A()),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Add certification..."}),e.jsx("button",{type:"button",onClick:A,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:null==R?void 0:R.map(r=>e.jsxs("span",{className:"flex items-center gap-1 px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-full text-sm",children:[r,e.jsx("button",{type:"button",onClick:()=>(e=>{P("certifications",R.filter(r=>r!==e))})(r),className:"text-gray-500 hover:text-red-500",children:"Ã—"})]},r))})]}):e.jsx("div",{className:"flex flex-wrap gap-2",children:(null==(n=null==t?void 0:t.certifications)?void 0:n.map(r=>e.jsx("span",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-full text-sm",children:r},r)))||e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No certifications"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Rating"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex items-center",children:[...Array(5)].map((r,a)=>e.jsx("svg",{className:"w-5 h-5 "+(a<Math.floor((null==t?void 0:t.rating)||0)?"text-yellow-400":"text-gray-300 dark:text-gray-600"),fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},a))}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[null==(o=null==t?void 0:t.rating)?void 0:o.toFixed(1)," (",(null==t?void 0:t.reviewsCount)||0," reviews)"]})]})]}),d&&e.jsxs(r.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"submit",disabled:m,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 transition-colors font-medium",children:m?"Saving...":"Save Changes"}),e.jsx("button",{type:"button",onClick:()=>{M(),c(!1)},className:"px-6 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors font-medium",children:"Cancel"})]})]})]})},N={blue:"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400",green:"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400",orange:"bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400",purple:"bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400"},w=({title:t,value:a,subtitle:s,icon:i,trend:l,color:n="blue"})=>e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:t}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a}),s&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:s}),l&&e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsxs("span",{className:"text-sm font-medium "+(l.isPositive?"text-green-600":"text-red-600"),children:[l.isPositive?"+":"",l.value,"%"]}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 ml-1",children:"vs last week"})]})]}),e.jsx("div",{className:`p-3 rounded-lg ${N[n]}`,children:i})]})}),S=({requestsToday:r,acceptanceRate:t,avgResponseTime:a,totalEarnings:s})=>e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-6 lg:mb-8",children:[e.jsx(w,{title:"Requests Today",value:r,subtitle:"New service requests",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),color:"blue",trend:{value:12,isPositive:!0}}),e.jsx(w,{title:"Acceptance Rate",value:`${t}%`,subtitle:"Requests accepted",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"green",trend:{value:5,isPositive:!0}}),e.jsx(w,{title:"Avg Response Time",value:a,subtitle:"Time to respond",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"orange"}),e.jsx(w,{title:"This Week's Earnings",value:`$${s.toFixed(2)}`,subtitle:"Total revenue",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),color:"purple",trend:{value:18,isPositive:!0}})]}),C=()=>{var a;const[i,l]=s.useState(!0),[g,p]=s.useState([]),[h,N]=s.useState(!0),[w,C]=s.useState(null),[P,M]=s.useState("time"),[L,R]=s.useState(null),{requests:A,loading:T,refetch:E}=j({enabled:!0,intervalMs:2e4,radius:50,useMockData:!0}),q={lat:40.7128,lng:-74.006};s.useEffect(()=>{const e=b();R(e)},[]);const D=s.useMemo(()=>{var e;return(null==(e=null==L?void 0:L.serviceCategories)?void 0:e.length)?A.filter(e=>L.serviceCategories.includes(e.categoryName)):[]},[A,L]),W=s.useMemo(()=>{const e=(new Date).toDateString(),r=D.filter(r=>new Date(r.createdAt).toDateString()===e).length,t=D.filter(e=>["accepted","in_progress","completed"].includes(e.status)).length;return{requestsToday:r,acceptanceRate:D.length>0?Math.round(t/D.length*100):0,avgResponseTime:"1.2 hours",totalEarnings:1250.75}},[D]);s.useEffect(()=>{let e=!0;return(async()=>{try{const r=await n();if(e){const e=Array.isArray(r)?r:[];p(e)}}catch{e&&p([{id:"l1",title:"Pipe Installation",price:120,status:"available",views:142,rating:4.6,description:"Residential pipe fitting"},{id:"l2",title:"AC Repair",price:80,status:"sold",views:98,rating:4.4,description:"Split AC diagnostics and repair"}])}finally{e&&l(!1)}})(),()=>{e=!1}},[]);const[B]=s.useState([{id:"m1",from:"Jane",content:"Is the AC repair available this weekend?",at:(new Date).toISOString()},{id:"m2",from:"Mark",content:"Can you provide an invoice for the last job?",at:new Date(Date.now()-36e5).toISOString()}]),[H,I]=s.useState(null),z=e=>p(r=>r.map(r=>r.id===e?{...r,status:"available"===r.status?"sold":"available"}:r)),V=e=>{p(r=>r.filter(r=>r.id!==e)),m(e).catch(()=>{})},F=async e=>{try{C(e),await new Promise(e=>setTimeout(e,1e3)),alert("Request accepted! You can now view it in your accepted requests."),E()}catch(r){alert("Failed to accept request. Please try again.")}finally{C(null)}},O=[...D].sort((e,r)=>"price"===P?r.currentPrice-e.currentPrice:"distance"===P?0:new Date(r.createdAt).getTime()-new Date(e.createdAt).getTime());return e.jsxs("section",{className:"max-w-none",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Seller Dashboard"}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Welcome back, ",(null==L?void 0:L.name)||"Seller","!"]})]}),e.jsx(S,{...W}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 lg:gap-6",children:[e.jsx("div",{className:"xl:col-span-1","data-profile-section":!0,children:e.jsx(k,{initial:L||void 0,onSubmit:e=>{const r=y(e);R(r)}})}),e.jsxs("div",{className:"xl:col-span-2 space-y-4 lg:space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 gap-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold",children:"Relevant Service Requests"}),D.length>0&&e.jsxs(r.span,{initial:{scale:0},animate:{scale:1},className:"px-3 py-1 rounded-full bg-primary-100 dark:bg-primary-900/30 text-primary-800 dark:text-primary-200 text-sm font-bold self-start sm:self-auto",children:[D.length," matching your services"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3",children:[e.jsxs("select",{value:P,onChange:e=>M(e.target.value),className:"px-3 py-1.5 rounded-lg border border-gray-300 dark:border-gray-600 text-sm dark:bg-slate-800",children:[e.jsx("option",{value:"time",children:"Newest First"}),e.jsx("option",{value:"price",children:"Highest Price"}),e.jsx("option",{value:"distance",children:"Nearest"})]}),e.jsxs("button",{onClick:()=>N(!h),className:"text-primary-600 dark:text-primary-400 hover:underline text-sm font-medium",children:[h?"Hide":"Show"," (",D.length,")"]})]})]}),e.jsx(t,{children:h&&e.jsx(r.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},children:T?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Array.from({length:4}).map((r,t)=>e.jsxs("div",{className:"rounded-xl border p-4 dark:border-slate-700",children:[e.jsx(o,{className:"h-5 w-1/3"}),e.jsx(d,{className:"mt-2",lines:3})]},t))}):(null==(a=null==L?void 0:L.serviceCategories)?void 0:a.length)?O.length>0?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:O.map(r=>e.jsx(c,{request:r,viewType:"seller",sellerLocation:q,onAccept:F,accepting:w===r.id},r.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-400 dark:text-gray-600 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No relevant requests at the moment"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:"We're checking every 20 seconds for new requests matching your services"})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-400 dark:text-gray-600 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Service Categories Selected"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Please select your service categories in your profile to see relevant requests."}),e.jsx("button",{onClick:()=>{const e=document.querySelector("[data-profile-section]");null==e||e.scrollIntoView({behavior:"smooth"})},className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Update Profile"})]})})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Your Service Listings"})}),i?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:Array.from({length:2}).map((r,t)=>e.jsxs("div",{className:"rounded-xl border p-4 dark:border-slate-700",children:[e.jsx(o,{className:"h-5 w-1/3"}),e.jsx(d,{className:"mt-2",lines:2})]},t))}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:g.map(r=>e.jsx(v,{listing:r,onToggleStatus:z,onEdit:e=>I(g.find(r=>r.id===e)??null),onRemove:V},r.id))})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:H?"Edit Listing":"Add New Listing"}),e.jsx(f,{initial:H?{title:H.title,price:H.price,description:H.description}:void 0,onSubmit:H?e=>{if(!H)return;p(r=>r.map(r=>r.id===H.id?{...r,...e,price:Number(e.price)}:r));const r=H.id;I(null),u(r,e).catch(()=>{})}:e=>{const r={id:Math.random().toString(36).slice(2),title:e.title,price:Number(e.price),description:e.description,status:"available",views:0,rating:0};p(e=>[r,...e]),x(e).catch(()=>{})}}),H&&e.jsx("button",{className:"mt-3 rounded-md border px-3 py-1.5 text-sm hover:bg-slate-50 dark:hover:bg-slate-800",onClick:()=>I(null),children:"Cancel"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Recent Messages"}),e.jsx("div",{className:"space-y-3",children:B.map(r=>e.jsxs("div",{className:"rounded-lg border border-slate-200 p-3 text-sm dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:r.from}),e.jsx("span",{className:"text-slate-500",children:new Date(r.at).toLocaleString()})]}),e.jsx("p",{className:"mt-1 text-slate-700 dark:text-slate-300",children:r.content})]},r.id))})]})]})]})]})};export{C as SellerDashboardPage};
//# sourceMappingURL=SellerDashboardPage-CG9gBqMU.js.map
