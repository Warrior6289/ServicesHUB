import{j as e,m as t}from"./ui-D5g_oJ6l.js";import{r}from"./vendor-BQpy66Z4.js";import{f as a,a as s,L as d}from"./router-Crx9FcUI.js";import{P as i}from"./PriceBoostModal-BqAXVxqT.js";import{m as l}from"./serviceRequests-CJCfd_jz.js";const c=["pending","accepted","in_progress","completed"],n=({request:r})=>{const a=(()=>{const e=c.indexOf(r.status);return c.map((t,a)=>{let s;return"pending"===t&&r.createdAt?s=r.createdAt:"accepted"===t&&r.acceptedAt&&(s=r.acceptedAt),{status:t,label:o(t),timestamp:s,active:t===r.status,completed:a<e}})})(),s=e=>new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),d=["price_boosted","converted_to_scheduled","cancelled","expired"].includes(r.status);return e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"Request Status"}),d&&e.jsx(t.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 p-4 rounded-lg "+("price_boosted"===r.status?"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800":"converted_to_scheduled"===r.status?"bg-cyan-50 dark:bg-cyan-900/20 border border-cyan-200 dark:border-cyan-800":"cancelled"===r.status?"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800":"bg-gray-50 dark:bg-gray-900/20 border border-gray-200 dark:border-gray-800"),children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-5 h-5 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["price_boosted"===r.status&&"Price was boosted","converted_to_scheduled"===r.status&&"Converted to scheduled request","cancelled"===r.status&&"Request was cancelled","expired"===r.status&&"Request expired"]}),e.jsxs("p",{className:"text-sm opacity-75 mt-1",children:["price_boosted"===r.status&&`Price increased to $${r.currentPrice.toFixed(2)}`,"converted_to_scheduled"===r.status&&"No instant service providers accepted. You can now manually schedule.","cancelled"===r.status&&"This request has been cancelled and is no longer active.","expired"===r.status&&"This instant request expired without being accepted."]})]})]})}),!["cancelled","expired"].includes(r.status)&&e.jsx("div",{className:"relative",children:a.map((r,d)=>{const i=d===a.length-1;return e.jsxs("div",{className:"relative pb-8 last:pb-0",children:[!i&&e.jsx("div",{className:"absolute left-4 top-8 bottom-0 w-0.5 bg-gray-200 dark:bg-gray-700",children:r.completed&&e.jsx(t.div,{initial:{height:0},animate:{height:"100%"},className:"bg-primary-600 w-full"})}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 rounded-full border-2 flex items-center justify-center "+(r.completed?"bg-primary-600 border-primary-600":r.active?"bg-white dark:bg-slate-800 border-primary-600":"bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600"),children:r.completed?e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):r.active?e.jsx("div",{className:"w-3 h-3 rounded-full bg-primary-600 animate-pulse"}):e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400 dark:bg-gray-500"})})}),e.jsxs("div",{className:"flex-1 pt-0.5",children:[e.jsxs("p",{className:"font-medium "+(r.active||r.completed?"text-gray-900 dark:text-white":"text-gray-500 dark:text-gray-400"),children:[r.label,r.active&&e.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs rounded-full bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300",children:"Current"})]}),r.timestamp&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:s(r.timestamp)})]})]})]},r.status)})}),r.priceHistory.length>1&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3",children:"Price History"}),e.jsx("div",{className:"space-y-2",children:r.priceHistory.map((t,a)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:s(t.timestamp)}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["$",t.price.toFixed(2),a>0&&e.jsxs("span",{className:"ml-2 text-xs text-orange-600 dark:text-orange-400",children:["+",(100*(t.price/r.priceHistory[0].price-1)).toFixed(0),"%"]})]})]},a))})]})]})};function o(e){return{pending:"Request Submitted",price_boosted:"Price Boosted",converted_to_scheduled:"Converted to Scheduled",accepted:"Provider Accepted",in_progress:"Service in Progress",completed:"Service Completed",cancelled:"Cancelled",expired:"Expired"}[e]}const x=()=>{const{id:c}=a(),o=s(),[x,m]=r.useState(null),[g,h]=r.useState(!0),[p,u]=r.useState(!1),[y,b]=r.useState(!1);r.useEffect(()=>{(async()=>{if(c)try{h(!0);const e=l.find(e=>e.id===c);if(!e)throw new Error("Request not found");m(e)}catch(e){alert("Request not found"),o("/dashboard")}finally{h(!1)}})()},[c,o]);if(g)return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-primary-600 border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Loading request..."})]})});if(!x)return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Request not found"}),e.jsx(d,{to:"/dashboard",className:"text-primary-600 hover:underline mt-2 inline-block",children:"Return to Dashboard"})]})});const j="instant"===x.type&&["pending","price_boosted"].includes(x.status),v=["pending","price_boosted"].includes(x.status);return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-900",children:[e.jsx("div",{className:"bg-white dark:bg-slate-800 border-b border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("button",{onClick:()=>o(-1),className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[x.categoryName," Request"]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Request ID: ",x.id]})]}),j&&e.jsx("button",{onClick:()=>u(!0),className:"px-6 py-2 rounded-lg bg-orange-600 text-white font-medium hover:bg-orange-700 transition-colors",children:"Boost Price"})]})})}),e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Request Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Description"}),e.jsx("p",{className:"text-gray-900 dark:text-white mt-1",children:x.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Type"}),e.jsx("p",{className:"text-gray-900 dark:text-white mt-1 capitalize",children:"instant"===x.type?e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-purple-500"}),"Instant Service"]}):e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"}),"Scheduled Service"]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Created"}),e.jsx("p",{className:"text-gray-900 dark:text-white mt-1",children:new Date(x.createdAt).toLocaleString()})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Current Price"}),e.jsxs("p",{className:"text-2xl font-bold text-primary-600 dark:text-primary-400 mt-1",children:["$",x.currentPrice.toFixed(2)]}),x.currentPrice>x.initialPrice&&e.jsxs("p",{className:"text-sm text-orange-600 dark:text-orange-400",children:["(Originally $",x.initialPrice.toFixed(2),")"]})]}),"instant"===x.type&&x.broadcastRadius&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Broadcast Radius"}),e.jsxs("p",{className:"text-gray-900 dark:text-white mt-1",children:[x.broadcastRadius," km"]})]}),"scheduled"===x.type&&x.scheduledDate&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Scheduled For"}),e.jsx("p",{className:"text-gray-900 dark:text-white mt-1",children:new Date(x.scheduledDate).toLocaleDateString()}),x.scheduledTimeSlot&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:x.scheduledTimeSlot})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Location"}),e.jsx("p",{className:"text-gray-900 dark:text-white mt-1",children:x.buyerLocation.address}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Coordinates: ",x.buyerLocation.lat.toFixed(4),", ",x.buyerLocation.lng.toFixed(4)]})]}),x.acceptedBy&&e.jsx("div",{className:"p-4 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-green-600 dark:text-green-400 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900 dark:text-green-300",children:"Request Accepted"}),e.jsxs("p",{className:"text-sm text-green-700 dark:text-green-400 mt-1",children:["Provider ID: ",x.acceptedBy,x.acceptedAt&&e.jsxs("span",{className:"ml-2",children:["â€¢ Accepted ",new Date(x.acceptedAt).toLocaleString()]})]})]})]})})]})]}),e.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Messages"}),e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),e.jsx("p",{className:"text-sm",children:"Messaging feature coming soon"}),e.jsx("p",{className:"text-xs mt-1",children:"You'll be able to chat with service providers here"})]})]})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsx(n,{request:x})}),v&&e.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Actions"}),e.jsx("button",{onClick:async()=>{if(x&&window.confirm("Are you sure you want to cancel this request?"))try{await new Promise(e=>setTimeout(e,500)),alert("Request cancelled successfully"),o("/dashboard")}catch(e){alert("Failed to cancel request. Please try again.")}},className:"w-full px-4 py-3 rounded-lg border-2 border-red-300 dark:border-red-600 text-red-600 dark:text-red-400 font-medium hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:"Cancel Request"})]})]})]})}),x&&e.jsx(i,{isOpen:p,onClose:()=>u(!1),currentPrice:x.currentPrice,onConfirm:async e=>{if(x)try{b(!0),await new Promise(e=>setTimeout(e,1e3));const t={...x,currentPrice:e,status:"price_boosted",priceHistory:[...x.priceHistory,{price:e,timestamp:(new Date).toISOString()}],updatedAt:(new Date).toISOString()};m(t),u(!1),alert("Price boosted successfully! Your request is now more attractive to service providers.")}catch(t){alert("Failed to boost price. Please try again.")}finally{b(!1)}},loading:y})]})};export{x as ServiceRequestDetailsPage};
//# sourceMappingURL=ServiceRequestDetailsPage-BRUKR3vU.js.map
